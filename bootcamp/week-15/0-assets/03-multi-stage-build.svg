<svg viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="450" fill="#1a1a2e"/>
  
  <!-- Title -->
  <text x="400" y="35" font-family="Inter, sans-serif" font-size="20" font-weight="600" fill="#009688" text-anchor="middle">
    Multi-stage Build
  </text>
  
  <!-- Stage 1: Builder -->
  <g transform="translate(50, 60)">
    <rect x="0" y="0" width="320" height="320" rx="8" fill="#252540" stroke="#2196F3" stroke-width="2"/>
    <text x="160" y="30" font-family="Inter, sans-serif" font-size="16" font-weight="600" fill="#2196F3" text-anchor="middle">Stage 1: Builder</text>
    
    <!-- FROM -->
    <g transform="translate(20, 50)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#2196F3" opacity="0.15"/>
      <text x="10" y="22" font-family="monospace" font-size="11" fill="#90caf9">FROM python:3.13-slim AS builder</text>
    </g>
    
    <!-- WORKDIR -->
    <g transform="translate(20, 95)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#1a1a2e"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#888">WORKDIR /app</text>
    </g>
    
    <!-- venv -->
    <g transform="translate(20, 130)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#4CAF50" opacity="0.15"/>
      <text x="10" y="22" font-family="monospace" font-size="11" fill="#a5d6a7">RUN python -m venv /opt/venv</text>
    </g>
    
    <!-- COPY requirements -->
    <g transform="translate(20, 175)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#1a1a2e"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#888">COPY requirements.txt .</text>
    </g>
    
    <!-- pip install -->
    <g transform="translate(20, 210)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#FF9800" opacity="0.15"/>
      <text x="10" y="22" font-family="monospace" font-size="11" fill="#ffcc80">RUN pip install -r requirements.txt</text>
    </g>
    
    <!-- Size indicator -->
    <g transform="translate(20, 270)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#f44336" opacity="0.2"/>
      <text x="140" y="22" font-family="Inter, sans-serif" font-size="12" fill="#ef9a9a" text-anchor="middle">
        ðŸ“¦ ~800MB (build tools, cache)
      </text>
    </g>
  </g>
  
  <!-- Arrow -->
  <g transform="translate(380, 200)">
    <path d="M 0 20 L 40 20" stroke="#009688" stroke-width="3" marker-end="url(#arrow2)"/>
    <text x="20" y="50" font-family="Inter, sans-serif" font-size="10" fill="#80cbc4" text-anchor="middle">COPY --from</text>
  </g>
  <defs>
    <marker id="arrow2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#009688"/>
    </marker>
  </defs>
  
  <!-- Stage 2: Runtime -->
  <g transform="translate(430, 60)">
    <rect x="0" y="0" width="320" height="320" rx="8" fill="#252540" stroke="#4CAF50" stroke-width="2"/>
    <text x="160" y="30" font-family="Inter, sans-serif" font-size="16" font-weight="600" fill="#4CAF50" text-anchor="middle">Stage 2: Runtime</text>
    
    <!-- FROM -->
    <g transform="translate(20, 50)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#4CAF50" opacity="0.15"/>
      <text x="10" y="22" font-family="monospace" font-size="11" fill="#a5d6a7">FROM python:3.13-slim AS runtime</text>
    </g>
    
    <!-- Create user -->
    <g transform="translate(20, 95)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#9C27B0" opacity="0.15"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#ce93d8">RUN useradd appuser</text>
    </g>
    
    <!-- COPY venv -->
    <g transform="translate(20, 130)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#009688" opacity="0.2"/>
      <text x="10" y="22" font-family="monospace" font-size="11" fill="#80cbc4">COPY --from=builder /opt/venv</text>
    </g>
    
    <!-- COPY src -->
    <g transform="translate(20, 175)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#1a1a2e"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#888">COPY src/ ./src/</text>
    </g>
    
    <!-- USER -->
    <g transform="translate(20, 210)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#9C27B0" opacity="0.15"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#ce93d8">USER appuser</text>
    </g>
    
    <!-- CMD -->
    <g transform="translate(20, 245)">
      <rect x="0" y="0" width="280" height="25" rx="4" fill="#1a1a2e"/>
      <text x="10" y="17" font-family="monospace" font-size="11" fill="#888">CMD ["uvicorn", "src.main:app"]</text>
    </g>
    
    <!-- Size indicator -->
    <g transform="translate(20, 285)">
      <rect x="0" y="0" width="280" height="35" rx="4" fill="#4CAF50" opacity="0.2"/>
      <text x="140" y="22" font-family="Inter, sans-serif" font-size="12" fill="#a5d6a7" text-anchor="middle">
        ðŸ“¦ ~150MB (runtime only)
      </text>
    </g>
  </g>
  
  <!-- Benefits -->
  <g transform="translate(50, 400)">
    <text x="0" y="15" font-family="Inter, sans-serif" font-size="12" fill="#4CAF50">âœ“ 80% smaller image</text>
    <text x="180" y="15" font-family="Inter, sans-serif" font-size="12" fill="#4CAF50">âœ“ No build tools in production</text>
    <text x="420" y="15" font-family="Inter, sans-serif" font-size="12" fill="#4CAF50">âœ“ Non-root user</text>
    <text x="580" y="15" font-family="Inter, sans-serif" font-size="12" fill="#4CAF50">âœ“ Fewer vulnerabilities</text>
  </g>
</svg>
