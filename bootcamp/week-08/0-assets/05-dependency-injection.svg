<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 550">
  <defs>
    <marker id="arrG" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#81C784"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="850" height="550" fill="#1a1a2e"/>
  
  <!-- Title -->
  <text x="425" y="30" font-family="Inter, sans-serif" font-size="20" font-weight="bold" fill="#ffffff" text-anchor="middle">Dependency Injection en FastAPI</text>
  
  <!-- Database -->
  <ellipse cx="100" cy="100" rx="60" ry="25" fill="#7E57C2"/>
  <rect x="40" y="100" width="120" height="40" fill="#7E57C2"/>
  <ellipse cx="100" cy="140" rx="60" ry="25" fill="#5E35B1"/>
  <text x="100" y="125" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#EDE7F6" text-anchor="middle">Session</text>
  
  <!-- get_db -->
  <rect x="200" y="90" width="140" height="60" rx="8" fill="#37474F"/>
  <text x="270" y="115" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#ECEFF1" text-anchor="middle">get_db()</text>
  <text x="270" y="135" font-family="monospace" font-size="9" fill="#B0BEC5" text-anchor="middle">→ Session</text>
  
  <path d="M160 120 L195 120" stroke="#81C784" stroke-width="2" marker-end="url(#arrG)"/>
  
  <!-- Repository factories -->
  <rect x="400" y="50" width="180" height="55" rx="8" fill="#EF6C00"/>
  <text x="490" y="75" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#FFF3E0" text-anchor="middle">get_user_repository()</text>
  <text x="490" y="93" font-family="monospace" font-size="9" fill="#FFE0B2" text-anchor="middle">db = Depends(get_db)</text>
  
  <rect x="400" y="115" width="180" height="55" rx="8" fill="#EF6C00"/>
  <text x="490" y="140" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#FFF3E0" text-anchor="middle">get_product_repository()</text>
  <text x="490" y="158" font-family="monospace" font-size="9" fill="#FFE0B2" text-anchor="middle">db = Depends(get_db)</text>
  
  <rect x="400" y="180" width="180" height="55" rx="8" fill="#EF6C00"/>
  <text x="490" y="205" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#FFF3E0" text-anchor="middle">get_order_repository()</text>
  <text x="490" y="223" font-family="monospace" font-size="9" fill="#FFE0B2" text-anchor="middle">db = Depends(get_db)</text>
  
  <!-- Arrows to repos -->
  <path d="M340 120 L395 77" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  <path d="M340 120 L395 142" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  <path d="M340 120 L395 207" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  
  <!-- Service factories -->
  <rect x="640" y="50" width="180" height="55" rx="8" fill="#2E7D32"/>
  <text x="730" y="75" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#E8F5E9" text-anchor="middle">get_user_service()</text>
  <text x="730" y="93" font-family="monospace" font-size="9" fill="#C8E6C9" text-anchor="middle">repo = Depends(...)</text>
  
  <rect x="640" y="115" width="180" height="55" rx="8" fill="#2E7D32"/>
  <text x="730" y="140" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#E8F5E9" text-anchor="middle">get_product_service()</text>
  <text x="730" y="158" font-family="monospace" font-size="9" fill="#C8E6C9" text-anchor="middle">repos = Depends(...)</text>
  
  <rect x="640" y="180" width="180" height="70" rx="8" fill="#2E7D32"/>
  <text x="730" y="205" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#E8F5E9" text-anchor="middle">get_order_service()</text>
  <text x="730" y="223" font-family="monospace" font-size="9" fill="#C8E6C9" text-anchor="middle">order_repo = Depends(...)</text>
  <text x="730" y="238" font-family="monospace" font-size="9" fill="#C8E6C9" text-anchor="middle">user_repo = Depends(...)</text>
  
  <!-- Arrows to services -->
  <path d="M580 77 L635 77" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  <path d="M580 142 L635 142" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  <path d="M580 207 L635 215" stroke="#81C784" stroke-width="1.5" marker-end="url(#arrG)"/>
  
  <!-- Router example -->
  <rect x="250" y="310" width="350" height="180" rx="10" fill="#0277BD"/>
  <text x="425" y="340" font-family="Inter, sans-serif" font-size="14" font-weight="bold" fill="#E1F5FE" text-anchor="middle">Router Endpoint</text>
  <line x1="270" y1="355" x2="580" y2="355" stroke="#B3E5FC" stroke-width="1"/>
  
  <text x="270" y="380" font-family="monospace" font-size="11" fill="#E1F5FE">@router.post("/orders/")</text>
  <text x="270" y="400" font-family="monospace" font-size="11" fill="#E1F5FE">def create_order(</text>
  <text x="290" y="420" font-family="monospace" font-size="11" fill="#81C784">data: OrderCreate,</text>
  <text x="290" y="440" font-family="monospace" font-size="11" fill="#FFB74D">service: OrderService = Depends(</text>
  <text x="310" y="460" font-family="monospace" font-size="11" fill="#FFB74D">get_order_service</text>
  <text x="290" y="480" font-family="monospace" font-size="11" fill="#FFB74D">)</text>
  
  <!-- Arrow from service to router -->
  <path d="M730 250 L730 290 L600 320" stroke="#81C784" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#arrG)"/>
  
  <!-- Explanation box -->
  <rect x="640" y="310" width="180" height="130" rx="8" fill="#263238"/>
  <text x="730" y="335" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#ECEFF1" text-anchor="middle">¿Qué sucede?</text>
  <line x1="655" y1="345" x2="805" y2="345" stroke="#455A64" stroke-width="1"/>
  <text x="660" y="365" font-family="Inter, sans-serif" font-size="9" fill="#B0BEC5">1. FastAPI llama get_db</text>
  <text x="660" y="382" font-family="Inter, sans-serif" font-size="9" fill="#B0BEC5">2. Con Session, crea repos</text>
  <text x="660" y="399" font-family="Inter, sans-serif" font-size="9" fill="#B0BEC5">3. Con repos, crea service</text>
  <text x="660" y="416" font-family="Inter, sans-serif" font-size="9" fill="#B0BEC5">4. Inyecta service al endpoint</text>
  <text x="660" y="433" font-family="Inter, sans-serif" font-size="9" fill="#81C784">¡Automáticamente!</text>
  
  <!-- Benefits -->
  <rect x="30" y="310" width="180" height="130" rx="8" fill="#263238"/>
  <text x="120" y="335" font-family="Inter, sans-serif" font-size="11" font-weight="bold" fill="#ECEFF1" text-anchor="middle">Beneficios</text>
  <line x1="45" y1="345" x2="195" y2="345" stroke="#455A64" stroke-width="1"/>
  <text x="50" y="365" font-family="Inter, sans-serif" font-size="9" fill="#81C784">✓ Desacoplamiento</text>
  <text x="50" y="382" font-family="Inter, sans-serif" font-size="9" fill="#81C784">✓ Testeable (mocks)</text>
  <text x="50" y="399" font-family="Inter, sans-serif" font-size="9" fill="#81C784">✓ Reutilizable</text>
  <text x="50" y="416" font-family="Inter, sans-serif" font-size="9" fill="#81C784">✓ Manejo de ciclo de vida</text>
  <text x="50" y="433" font-family="Inter, sans-serif" font-size="9" fill="#81C784">✓ Tipado fuerte</text>
  
  <!-- Footer -->
  <text x="425" y="530" font-family="Inter, sans-serif" font-size="10" fill="#666" text-anchor="middle">Semana 08 - Bootcamp FastAPI</text>
</svg>
