<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 480">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#009688"/>
      <stop offset="100%" style="stop-color:#00796B"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="480" fill="#1a1a2e"/>
  
  <!-- Header -->
  <rect x="0" y="0" width="800" height="60" fill="url(#headerGrad)"/>
  <text x="400" y="38" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">Security Headers</text>
  
  <!-- Browser -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="200" height="140" rx="8" fill="#16213e" stroke="#2196F3" stroke-width="2"/>
    <rect x="0" y="0" width="200" height="25" rx="8" fill="#2196F3"/>
    <circle cx="15" cy="12" r="5" fill="#f44336"/>
    <circle cx="30" cy="12" r="5" fill="#FF9800"/>
    <circle cx="45" cy="12" r="5" fill="#4CAF50"/>
    <text x="100" y="17" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">Browser</text>
    
    <text x="100" y="60" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">GET /api/data</text>
    <text x="100" y="80" font-family="Arial, sans-serif" font-size="10" fill="#aaa" text-anchor="middle">Origin: app.com</text>
  </g>
  
  <!-- Arrow Request -->
  <path d="M 260 150 L 340 150" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="300" y="140" font-family="Arial, sans-serif" font-size="10" fill="#4CAF50" text-anchor="middle">Request</text>
  
  <!-- Server -->
  <g transform="translate(350, 80)">
    <rect x="0" y="0" width="200" height="140" rx="8" fill="#16213e" stroke="#009688" stroke-width="2"/>
    <text x="100" y="25" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#009688" text-anchor="middle">FastAPI Server</text>
    
    <text x="100" y="55" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">Security Middleware</text>
    <rect x="20" y="65" width="160" height="60" rx="4" fill="#0f3460"/>
    <text x="100" y="85" font-family="Arial, sans-serif" font-size="10" fill="#4CAF50" text-anchor="middle">+ Add Headers</text>
    <text x="100" y="100" font-family="Arial, sans-serif" font-size="10" fill="#4CAF50" text-anchor="middle">+ Check CORS</text>
    <text x="100" y="115" font-family="Arial, sans-serif" font-size="10" fill="#4CAF50" text-anchor="middle">+ Validate Origin</text>
  </g>
  
  <!-- Arrow Response -->
  <path d="M 340 170 L 260 170" stroke="#FF9800" stroke-width="2"/>
  <text x="300" y="185" font-family="Arial, sans-serif" font-size="10" fill="#FF9800" text-anchor="middle">Response</text>
  
  <!-- Headers Box -->
  <g transform="translate(580, 80)">
    <rect x="0" y="0" width="180" height="380" rx="8" fill="#16213e" stroke="#E91E63" stroke-width="2"/>
    <text x="90" y="25" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#E91E63" text-anchor="middle">Response Headers</text>
    
    <!-- Header items -->
    <g transform="translate(10, 40)">
      <rect x="0" y="0" width="160" height="40" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#4CAF50" text-anchor="middle">X-Content-Type-Options</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">nosniff</text>
    </g>
    
    <g transform="translate(10, 90)">
      <rect x="0" y="0" width="160" height="40" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#2196F3" text-anchor="middle">X-Frame-Options</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">DENY</text>
    </g>
    
    <g transform="translate(10, 140)">
      <rect x="0" y="0" width="160" height="40" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#FF9800" text-anchor="middle">X-XSS-Protection</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">1; mode=block</text>
    </g>
    
    <g transform="translate(10, 190)">
      <rect x="0" y="0" width="160" height="40" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#9C27B0" text-anchor="middle">Strict-Transport-Security</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">max-age=31536000</text>
    </g>
    
    <g transform="translate(10, 240)">
      <rect x="0" y="0" width="160" height="50" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#f44336" text-anchor="middle">Content-Security-Policy</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">default-src 'self';</text>
      <text x="80" y="42" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">script-src 'self'</text>
    </g>
    
    <g transform="translate(10, 300)">
      <rect x="0" y="0" width="160" height="40" rx="4" fill="#0f3460"/>
      <text x="80" y="15" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#00BCD4" text-anchor="middle">Referrer-Policy</text>
      <text x="80" y="30" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">strict-origin-when-cross</text>
    </g>
    
    <g transform="translate(10, 350)">
      <rect x="0" y="0" width="160" height="20" rx="4" fill="#0f3460"/>
      <text x="80" y="14" font-family="Arial, sans-serif" font-size="9" fill="#aaa" text-anchor="middle">+ CORS Headers...</text>
    </g>
  </g>
  
  <!-- CORS Section -->
  <g transform="translate(50, 250)">
    <rect x="0" y="0" width="500" height="200" rx="8" fill="#16213e" stroke="#FF9800" stroke-width="2"/>
    <text x="250" y="25" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#FF9800" text-anchor="middle">CORS (Cross-Origin Resource Sharing)</text>
    
    <!-- Preflight -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="220" height="70" rx="4" fill="#0f3460"/>
      <text x="110" y="18" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2196F3" text-anchor="middle">Preflight Request</text>
      <text x="110" y="35" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">OPTIONS /api/data</text>
      <text x="110" y="50" font-family="Arial, sans-serif" font-size="9" fill="#aaa" text-anchor="middle">Access-Control-Request-Method</text>
      <text x="110" y="62" font-family="Arial, sans-serif" font-size="9" fill="#aaa" text-anchor="middle">Access-Control-Request-Headers</text>
    </g>
    
    <!-- CORS Response -->
    <g transform="translate(260, 45)">
      <rect x="0" y="0" width="220" height="70" rx="4" fill="#0f3460"/>
      <text x="110" y="18" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#4CAF50" text-anchor="middle">CORS Response</text>
      <text x="110" y="35" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Access-Control-Allow-Origin</text>
      <text x="110" y="48" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Access-Control-Allow-Methods</text>
      <text x="110" y="61" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Access-Control-Allow-Headers</text>
    </g>
    
    <!-- Allowed Origins -->
    <g transform="translate(20, 125)">
      <text x="0" y="15" font-family="Arial, sans-serif" font-size="11" fill="white">Allowed Origins:</text>
      <rect x="110" y="0" width="120" height="22" rx="4" fill="#4CAF50"/>
      <text x="170" y="15" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">localhost:3000</text>
      <rect x="240" y="0" width="100" height="22" rx="4" fill="#4CAF50"/>
      <text x="290" y="15" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">app.com</text>
    </g>
    
    <!-- Blocked -->
    <g transform="translate(20, 160)">
      <text x="0" y="15" font-family="Arial, sans-serif" font-size="11" fill="white">Blocked:</text>
      <rect x="110" y="0" width="120" height="22" rx="4" fill="#f44336"/>
      <text x="170" y="15" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">evil-site.com</text>
      <text x="250" y="15" font-family="Arial, sans-serif" font-size="10" fill="#f44336">‚Üê CORS Error</text>
    </g>
  </g>
</svg>
