<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="bgGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="500" fill="url(#bgGrad3)"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#00d9ff" font-family="system-ui, sans-serif" font-size="22" font-weight="bold">Connection Manager Pattern</text>
  
  <!-- Connection Manager Box -->
  <rect x="280" y="60" width="240" height="180" rx="12" fill="#0f3460" stroke="#00d9ff" stroke-width="3"/>
  <text x="400" y="90" text-anchor="middle" fill="#00d9ff" font-family="system-ui, sans-serif" font-size="16" font-weight="bold">ConnectionManager</text>
  
  <!-- Manager properties -->
  <text x="300" y="120" fill="#a0a0a0" font-family="monospace" font-size="11">connections: list[WebSocket]</text>
  <text x="300" y="140" fill="#a0a0a0" font-family="monospace" font-size="11">rooms: dict[str, list]</text>
  
  <!-- Manager methods -->
  <line x1="295" y1="155" x2="505" y2="155" stroke="#2a2a4a" stroke-width="1"/>
  <text x="300" y="175" fill="#00ff88" font-family="monospace" font-size="11">async connect(ws)</text>
  <text x="300" y="195" fill="#ff4757" font-family="monospace" font-size="11">disconnect(ws)</text>
  <text x="300" y="215" fill="#ffaa00" font-family="monospace" font-size="11">async broadcast(msg)</text>
  <text x="300" y="235" fill="#00d9ff" font-family="monospace" font-size="11">async send_personal(ws, msg)</text>
  
  <!-- Clients -->
  <g transform="translate(50, 300)">
    <rect x="0" y="0" width="100" height="60" rx="8" fill="#009688"/>
    <text x="50" y="25" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Cliente 1</text>
    <text x="50" y="45" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="10">ws://...</text>
  </g>
  
  <g transform="translate(180, 300)">
    <rect x="0" y="0" width="100" height="60" rx="8" fill="#009688"/>
    <text x="50" y="25" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Cliente 2</text>
    <text x="50" y="45" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="10">ws://...</text>
  </g>
  
  <g transform="translate(520, 300)">
    <rect x="0" y="0" width="100" height="60" rx="8" fill="#009688"/>
    <text x="50" y="25" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Cliente 3</text>
    <text x="50" y="45" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="10">ws://...</text>
  </g>
  
  <g transform="translate(650, 300)">
    <rect x="0" y="0" width="100" height="60" rx="8" fill="#009688"/>
    <text x="50" y="25" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Cliente 4</text>
    <text x="50" y="45" text-anchor="middle" fill="#fff" font-family="system-ui, sans-serif" font-size="10">ws://...</text>
  </g>
  
  <!-- Connection lines to manager -->
  <line x1="100" y1="300" x2="320" y2="240" stroke="#00d9ff" stroke-width="2"/>
  <line x1="230" y1="300" x2="360" y2="240" stroke="#00d9ff" stroke-width="2"/>
  <line x1="570" y1="300" x2="440" y2="240" stroke="#00d9ff" stroke-width="2"/>
  <line x1="700" y1="300" x2="480" y2="240" stroke="#00d9ff" stroke-width="2"/>
  
  <!-- Rooms -->
  <g transform="translate(50, 400)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="none" stroke="#e91e63" stroke-width="2" stroke-dasharray="5"/>
    <text x="90" y="20" text-anchor="middle" fill="#e91e63" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Room: general</text>
    <text x="90" y="45" text-anchor="middle" fill="#a0a0a0" font-family="system-ui, sans-serif" font-size="10">Cliente 1, Cliente 2</text>
    <circle cx="50" cy="65" r="6" fill="#009688"/>
    <circle cx="70" cy="65" r="6" fill="#009688"/>
  </g>
  
  <g transform="translate(570, 400)">
    <rect x="0" y="0" width="180" height="80" rx="8" fill="none" stroke="#ffaa00" stroke-width="2" stroke-dasharray="5"/>
    <text x="90" y="20" text-anchor="middle" fill="#ffaa00" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">Room: tech</text>
    <text x="90" y="45" text-anchor="middle" fill="#a0a0a0" font-family="system-ui, sans-serif" font-size="10">Cliente 3, Cliente 4</text>
    <circle cx="50" cy="65" r="6" fill="#009688"/>
    <circle cx="70" cy="65" r="6" fill="#009688"/>
  </g>
  
  <!-- Broadcast arrows -->
  <g transform="translate(300, 400)">
    <text x="100" y="20" text-anchor="middle" fill="#ffaa00" font-family="system-ui, sans-serif" font-size="14" font-weight="bold">broadcast()</text>
    
    <!-- Arrow to room 1 -->
    <line x1="50" y1="40" x2="-30" y2="40" stroke="#ffaa00" stroke-width="2"/>
    <polygon points="-30,35 -40,40 -30,45" fill="#ffaa00"/>
    
    <!-- Arrow to room 2 -->
    <line x1="150" y1="40" x2="230" y2="40" stroke="#ffaa00" stroke-width="2"/>
    <polygon points="230,35 240,40 230,45" fill="#ffaa00"/>
  </g>
  
  <!-- Legend -->
  <g transform="translate(300, 480)">
    <line x1="0" y1="0" x2="20" y2="0" stroke="#00d9ff" stroke-width="2"/>
    <text x="30" y="4" fill="#a0a0a0" font-family="system-ui, sans-serif" font-size="10">Conexi√≥n activa</text>
    
    <rect x="120" y="-6" width="12" height="12" rx="2" fill="none" stroke="#e91e63" stroke-width="1" stroke-dasharray="2"/>
    <text x="140" y="4" fill="#a0a0a0" font-family="system-ui, sans-serif" font-size="10">Room/Sala</text>
    
    <line x1="220" y1="0" x2="240" y2="0" stroke="#ffaa00" stroke-width="2"/>
    <text x="250" y="4" fill="#a0a0a0" font-family="system-ui, sans-serif" font-size="10">Broadcast</text>
  </g>
</svg>
